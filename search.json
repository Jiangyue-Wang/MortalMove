[{"path":"http://www.jiangyue-wang.github.io/MortalMove/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Jiangyue Wang Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/fit-model-cmdstan.html","id":"simulating-data","dir":"Articles","previous_headings":"","what":"Simulating data","title":"Fitting a model using cmdstanr","text":"","code":"sim <- simulate_data(n_animals = 100, n_fixes = 200, n_dead = 20, n_knots = 25) sim[[\"raw_data\"]] <- NULL sim[[\"ind_cell_effect\"]] <- 0"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/fit-model-cmdstan.html","id":"fit-stan-model-using-cmdstan","dir":"Articles","previous_headings":"","what":"Fit stan model using cmdstan","title":"Fitting a model using cmdstanr","text":"","code":"model_file <- system.file(\"stan/mortality_model.stan\", package = \"MortalMove\") mod <- cmdstan_model(model_file, exe_file = system.file(\"stan/mortality_model.exe\", package = \"MortalMove\")) fit <- mod$sample(   data = sim,   chains = 2,   parallel_chains = 2,   iter_warmup = 500,   iter_sampling = 1500,   seed = 123 )"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/fit-model-cmdstan.html","id":"check-diagnostics","dir":"Articles","previous_headings":"","what":"Check diagnostics","title":"Fitting a model using cmdstanr","text":"","code":"diagnostic_fit(fit, plot = TRUE, observed_y = rowSums(sim$time_step, na.rm = TRUE), delta = sim$delta) #> This is posterior version 1.6.1 #>  #> Attaching package: 'posterior' #> The following object is masked from 'package:FNN': #>  #>     entropy #> The following objects are masked from 'package:stats': #>  #>     mad, sd, var #> The following objects are masked from 'package:base': #>  #>     %in%, match #> This is bayesplot version 1.14.0 #> - Online documentation and vignettes at mc-stan.org/bayesplot #> - bayesplot theme set to bayesplot::theme_default() #>    * Does _not_ affect other ggplot2 plots #>    * See ?bayesplot_theme_set for details on theme setting #>  #> Attaching package: 'bayesplot' #> The following object is masked from 'package:posterior': #>  #>     rhat #> This is loo version 2.8.0 #> - Online documentation and vignettes at mc-stan.org/loo #> - As of v2.0.0 loo defaults to 1 core but we recommend using as many as possible. Use the 'cores' argument or set options(mc.cores = NUM_CORES) for an entire session. #> # A tibble: 5 × 5 #>   variable   mean     sd      q5    q95 #>   <chr>     <dbl>  <dbl>   <dbl>  <dbl> #> 1 beta[1]   0.130 0.0548  0.0468  0.223 #> 2 beta[2]  -0.169 0.422  -0.882   0.519 #> 3 alpha[1] -1.71  0.348  -2.26   -1.13  #> 4 alpha[2]  0.354 0.0887  0.208   0.496 #> 5 llambda  -0.195 1.67   -3.01    2.49  #>  #> --- Rhat and ESS Summary --- #> # A tibble: 5 × 4 #>   variable  rhat ess_bulk ess_tail #>   <chr>    <dbl>    <dbl>    <dbl> #> 1 beta[1]   1.00    1605.    1934. #> 2 beta[2]   1.00    2407.    1981. #> 3 alpha[1]  1.00    1558.    1634. #> 4 alpha[2]  1.00    2055.    1564. #> 5 llambda   1.00    1634.    1593. #>  #> Computed from 3000 by 100 log-likelihood matrix. #>  #>          Estimate   SE #> elpd_loo   -132.9 25.1 #> p_loo         2.3  0.5 #> looic       265.7 50.1 #> ------ #> MCSE of elpd_loo is 0.0. #> MCSE and ESS estimates assume independent draws (r_eff=1). #>  #> All Pareto k estimates are good (k < 0.7). #> See help('pareto-k-diagnostic') for details. #>  #> Posterior predictive p-value summary: #>   variable p_value #> 1   Failed  0.3000 #> 2 Censored  0.7125 bayesplot::mcmc_trace(fit$draws(c(\"llambda\",\"alpha\",\"beta\")))"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/fit-model-cmdstan.html","id":"fit-with-spatial-autocorrelation","dir":"Articles","previous_headings":"","what":"Fit with spatial autocorrelation","title":"Fitting a model using cmdstanr","text":"","code":"# Fit with spatial autocorrelation sim[[\"ind_cell_effect\"]] <- 1 model_file <- system.file(\"stan/mortality_model.stan\", package = \"MortalMove\") mod <- cmdstan_model(model_file, exe_file = system.file(\"stan/mortality_model.exe\", package = \"MortalMove\"))  # run fewer iterations due to time constraint fit_spat <- mod$sample(   data = sim,   chains = 2,   parallel_chains = 2,   iter_warmup = 500,   iter_sampling = 1500,   seed = 123 ) diagnostic_fit(fit_spat, plot = TRUE, observed_y = rowSums(sim$time_step, na.rm = TRUE), delta = sim$delta) #> # A tibble: 5 × 5 #>   variable    mean     sd       q5    q95 #>   <chr>      <dbl>  <dbl>    <dbl>  <dbl> #> 1 beta[1]   0.0697 0.0593 -0.0252   0.171 #> 2 beta[2]  -0.316  0.416  -0.988    0.355 #> 3 alpha[1] -1.46   0.385  -2.09    -0.828 #> 4 alpha[2]  0.330  0.200  -0.00211  0.656 #> 5 llambda  -0.515  1.72   -3.39     2.29  #>  #> --- Rhat and ESS Summary --- #> # A tibble: 5 × 4 #>   variable  rhat ess_bulk ess_tail #>   <chr>    <dbl>    <dbl>    <dbl> #> 1 beta[1]  1.000    5544.    2325. #> 2 beta[2]  1.00     6495.    2025. #> 3 alpha[1] 1.00     3214.    2295. #> 4 alpha[2] 1.000    4593.    2214. #> 5 llambda  1.00     3087.    2266. #>  #> Computed from 3000 by 100 log-likelihood matrix. #>  #>          Estimate   SE #> elpd_loo   -125.2 24.3 #> p_loo         6.7  1.7 #> looic       250.5 48.6 #> ------ #> MCSE of elpd_loo is 0.1. #> MCSE and ESS estimates assume independent draws (r_eff=1). #>  #> All Pareto k estimates are good (k < 0.7). #> See help('pareto-k-diagnostic') for details. #>  #> Posterior predictive p-value summary: #>   variable p_value #> 1   Failed    0.40 #> 2 Censored    0.65 bayesplot::mcmc_trace(fit_spat$draws(c(\"llambda\",\"alpha\",\"beta\")))"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/prepare-data-for-stan.html","id":"required-data-structure","dir":"Articles","previous_headings":"","what":"Required data structure","title":"Get movement tracking datasets ready for modeling, fit the model using cmdstanr or rstan","text":"probably two data frames: one GPS fixes timestamps one individual information (e.g., age, sex, fate, etc.). first one following columns: animal_id: unique identifier individual timestamp: date-time GPS fix (converted lubridate::ymd_hms() format, numeric format seconds) x: x-coordinate (meters) y: y-coordinate (meters) habitat covariates want include. Please note want use categorical variables (e.g., 4 season), input variables independent columns (e.g., season_spring, season_summer, season_autumn, winter reference level), column binary variable indicating presence season. values numeric. , included prey availability (prey_avail) hunter density (hunter) habitat covariates. second one following columns: - animal_id: unique identifier individual - fate: fate individual (e.g., 0 alive, 1 dead) - habitat covariates want include. Please note want use categorical variables (e.g., sex), input variables independent columns (e.g., `sex_male’, 1 male, 0 female). values numeric. , included age sex individual covariates.","code":"head(df) #>           x        y animal_id timestamp prey_avail   hunter #> 1 495.44004 320.3625         1         1   5.179907 5.976312 #> 2  85.06545 219.6892         1         2   4.884911 4.535864 #> 3 329.58052 333.4154         1         3   5.230458 5.291962 #> 4 215.87068 260.6982         1         4   5.230458 5.291962 #> 5 109.47462 271.1017         1         5   4.884911 4.535864 #> 6 157.70392 252.8365         1         6   4.884911 4.535864 head(indv) #>   age sex_m animal_id fate #> 1  16     0         1    0 #> 2  20     0         2    0 #> 3   6     0         3    0 #> 4  11     0         4    0 #> 5   8     1         5    0 #> 6   7     0         6    0"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/prepare-data-for-stan.html","id":"prepare-data-for-modeling","dir":"Articles","previous_headings":"","what":"Prepare data for modeling","title":"Get movement tracking datasets ready for modeling, fit the model using cmdstanr or rstan","text":"First, need integrate two tables one data frame, used modeling. dplyr::left_join() function . , need change column name fate delta. Next, prepare data modeling. prepare_data_for_stan() function . can specify habitat covariates individual covariates want include model, well whether want include cell effect (.e., random effect grid cell). can also specify grid bounds resolution want include cell effect. grid bounds specified list xmin, xmax, ymin, ymax values, grid resolution specified meters. Please note grid bounds cover entire area data collected, difference xmax xmin, ymax ymin divisible grid resolution.","code":"df <- left_join(df, indv, by = \"animal_id\") df <- df %>%    dplyr::rename(delta = fate) head(df) #>           x        y animal_id timestamp prey_avail   hunter age sex_m delta #> 1 495.44004 320.3625         1         1   5.179907 5.976312  16     0     0 #> 2  85.06545 219.6892         1         2   4.884911 4.535864  16     0     0 #> 3 329.58052 333.4154         1         3   5.230458 5.291962  16     0     0 #> 4 215.87068 260.6982         1         4   5.230458 5.291962  16     0     0 #> 5 109.47462 271.1017         1         5   4.884911 4.535864  16     0     0 #> 6 157.70392 252.8365         1         6   4.884911 4.535864  16     0     0 df_stan_data <- prepare_stan_data(   df = df,   include_hab_cov = TRUE, include_ind_cov = TRUE,   hab_cov_names = c(\"hunter\", \"prey_avail\"),   ind_cov_names = c(\"age\", \"sex_m\"),   include_cell_effect = TRUE,   grid_bounds = list(xmin = 0, xmax = 1000, ymin = 0, ymax = 1000),   grid_res = 100 ) #>  #> Attaching package: 'lubridate' #> The following objects are masked from 'package:base': #>  #>     date, intersect, setdiff, union names(df_stan_data) #>  [1] \"n\"               \"max_locs\"        \"n_locs\"          \"time_step\"       #>  [5] \"delta\"           \"n_knots\"         \"knots_ce\"        \"sigma\"           #>  [9] \"rho\"             \"cell_mat\"        \"ind_cell_effect\" \"beta_prior\"      #> [13] \"llambda_prior\"   \"alpha_prior\"     \"num_hab_covs\"    \"hab_cov\"         #> [17] \"num_indv_covs\"   \"z\""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/prepare-data-for-stan.html","id":"fit-model-using-cmdstanr","dir":"Articles","previous_headings":"","what":"Fit model using cmdstanr","title":"Get movement tracking datasets ready for modeling, fit the model using cmdstanr or rstan","text":"generally faster fit model using cmdstanr rstan, requires bit compilation running. can install cmdstanr GitHub, set path CmdStan installation directory using set_cmdstan_path(). can specify number chains, iterations, parameters needed.","code":"library(cmdstanr) set_cmdstan_path(\"YOUR_CMD_PATH\") model_file <- system.file(\"stan/mortality_model.stan\", package = \"MortalMove\") mod <- cmdstan_model(model_file, exe_file = system.file(\"stan/mortality_model.exe\", package = \"MortalMove\")) fit <- mod$sample(   data = df_stan_data,   chains = 2,   parallel_chains = 2,   iter_warmup = 50,   iter_sampling = 150,   seed = 123 )"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/prepare-data-for-stan.html","id":"fit-model-using-rstan","dir":"Articles","previous_headings":"","what":"Fit model using rstan","title":"Get movement tracking datasets ready for modeling, fit the model using cmdstanr or rstan","text":"prefer use rstan, can well. ’s much simpler install, may take longer fit cmdstanr, especially complicated models spatial effects.","code":"library(rstan) model_file <- system.file(\"stan/mortality_model.stan\", package = \"MortalMove\") fit <- stan(   file = model_file,   data = df_stan_data,   chains = 2,   iter = 200,   warmup = 50,   seed = 123 )"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/simulating-data.html","id":"simulate-a-dataset","dir":"Articles","previous_headings":"","what":"Simulate a dataset","title":"Simulating Animal Movement and Mortality Data","text":"","code":"sim <- simulate_data(n_animals = 100, n_fixes = 200, n_dead = 20, n_knots = 25) str(sim, max.level = 1) #> List of 19 #>  $ n              : num 100 #>  $ max_locs       : num 200 #>  $ n_locs         : num [1:100] 48 194 111 23 195 137 177 61 39 31 ... #>  $ time_step      : num [1:100, 1:200] 1 1 1 1 1 1 1 1 1 1 ... #>  $ delta          : num [1:100(1d)] 0 0 0 0 0 0 1 0 0 0 ... #>   ..- attr(*, \"dimnames\")=List of 1 #>  $ n_knots        : num 25 #>  $ knots_ce       : num [1:25, 1:2] 100 300 500 700 900 100 300 500 700 900 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>  $ sigma          : num 1 #>  $ rho            : num 100 #>  $ cell_mat       : num [1:100, 1:200] 8 6 7 2 6 6 20 6 3 7 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>  $ ind_cell_effect: num 1 #>  $ beta_prior     : num [1:2] 0 1 #>  $ llambda_prior  : num [1:2] 0 2 #>  $ alpha_prior    : num [1:2] 0 1 #>  $ num_hab_covs   : num 2 #>  $ hab_cov        : num [1:100, 1:200, 1:2] 5.18 4.88 5.23 5.86 4.88 ... #>  $ num_indv_covs  : num 2 #>  $ z              : num [1:100, 1:2] 16 20 6 11 8 7 20 17 18 17 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>  $ raw_data       :'data.frame': 10957 obs. of  9 variables:"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/simulating-data.html","id":"plot-out-simulated-dataset---individual-monitoring-length-and-fate","dir":"Articles","previous_headings":"","what":"Plot out simulated dataset - individual monitoring length and fate","title":"Simulating Animal Movement and Mortality Data","text":"","code":"df <- data.frame(id = 1:sim$n, n_locs  = sim$n_locs, delta = sim$delta)  ggplot(df, aes(x = id, y = n_locs)) +   geom_point(aes(color = delta)) +   geom_segment(aes(xend = id, yend = 0, color = delta)) +   labs(x = \"Animal ID\", y = \"Time steps\") +   theme_minimal() +   ggtitle(\"Monitoring length and fate of each animal\") +   theme(axis.text.x = element_text(angle = 90, hjust = 1)) +   coord_flip()"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/simulating-data.html","id":"plot-out-simulated-dataset---individual-movement-paths","dir":"Articles","previous_headings":"","what":"Plot out simulated dataset - individual movement paths","title":"Simulating Animal Movement and Mortality Data","text":"","code":"df <- sim$raw_data df <- df[df$animal_id %in% c(1,13),] ggplot(df, aes(x = x, y = y, color = delta)) +   geom_path() +   geom_point() +   labs(x = \"X Coordinate\", y = \"Y Coordinate\") +   theme_minimal() +   ggtitle(\"Movement paths of animals\")"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/articles/simulating-data.html","id":"plot-some-covariates-by-fate","dir":"Articles","previous_headings":"","what":"Plot some covariates by fate","title":"Simulating Animal Movement and Mortality Data","text":"","code":"df <- sim$raw_data df$delta <- as.factor(df$delta) ggplot(df, aes(x = delta, y = hunter)) +   geom_boxplot() +   labs(x = \"Fate\", y = \"Hunter density\") +   theme_minimal() +   ggtitle(\"Hunter covariate by fate of animal\") +   scale_y_continuous(limits = c(0, 10)) ggplot(df, aes(x = delta, y = prey_avail)) +   geom_boxplot() +   labs(x = \"Fate\", y = \"Prey availability\") +   theme_minimal() +   ggtitle(\"Prey covariate by fate of animal\")"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jiangyue Wang. Author, maintainer.","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang J (2025). MortalMove: Estimate Animal Mortality Risk Movement Data. R package version 0.1.0, https://github.com/Jiangyue-Wang/MortalMove.","code":"@Manual{,   title = {MortalMove: Estimate Animal Mortality Risk from Movement Data},   author = {Jiangyue Wang},   year = {2025},   note = {R package version 0.1.0},   url = {https://github.com/Jiangyue-Wang/MortalMove}, }"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/index.html","id":"mortalmove","dir":"","previous_headings":"","what":"Estimate Animal Mortality Risk from Movement Data","title":"Estimate Animal Mortality Risk from Movement Data","text":"goal MortalMove estimate mortality risk animals based movement data individual characteristics, accounting spatial effects. provides functions prepare data modeling, fit models using Stan, visualize diagnostics.","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimate Animal Mortality Risk from Movement Data","text":"can install development version MortalMove GitHub :","code":"# install.packages(\"pak\") pak::pak(\"Jiangyue-Wang/MortalMove\")"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/diagnostic_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Diagnostics on CmdStan Fit — diagnostic_fit","title":"Perform Diagnostics on CmdStan Fit — diagnostic_fit","text":"Perform Diagnostics CmdStan Fit","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/diagnostic_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Diagnostics on CmdStan Fit — diagnostic_fit","text":"","code":"diagnostic_fit(fit, plot = TRUE, observed_y = NULL, delta = NULL)"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/diagnostic_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Diagnostics on CmdStan Fit — diagnostic_fit","text":"fit CmdStanMCMC object returned cmdstanr::sample() plot Logical; whether show diagnostic plots observed_y Optional vector observed values predictive p-value computed, survey/survival length individual delta Optional vector censoring indicators (0 = censored, 1 = dead/failed) predictive p-value computed","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/diagnostic_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform Diagnostics on CmdStan Fit — diagnostic_fit","text":"Invisible list diagnostics","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/prepare_stan_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Stan Data from Real Tracking Dataset — prepare_stan_data","title":"Prepare Stan Data from Real Tracking Dataset — prepare_stan_data","text":"Prepare Stan Data Real Tracking Dataset","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/prepare_stan_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Stan Data from Real Tracking Dataset — prepare_stan_data","text":"","code":"prepare_stan_data(   df,   include_hab_cov = TRUE,   include_ind_cov = TRUE,   hab_cov_names = c(\"prey_avail\", \"hunter\"),   ind_cov_names = c(\"age\", \"sex_m\"),   include_cell_effect = TRUE,   grid_bounds = NULL,   grid_res = NULL )"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/prepare_stan_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Stan Data from Real Tracking Dataset — prepare_stan_data","text":"df data.frame containing GPS points columns: x, y, animal_id, user-specified covariates include_hab_cov Logical; whether include habitat covariates include_ind_cov Logical; whether include individual-level covariates hab_cov_names Character vector habitat covariate column names ind_cov_names Character vector individual-level covariate column names include_cell_effect Logical; whether include spatial cell effect grid_bounds Named list xmin, xmax, ymin, ymax (required include_cell_effect = TRUE) grid_res Grid resolution meters (required include_cell_effect = TRUE), please make sure grid bounds divisible grid resolution","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/prepare_stan_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Stan Data from Real Tracking Dataset — prepare_stan_data","text":"named list ready passed CmdStan model","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/simulate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Animal Movement and Mortality Data — simulate_data","title":"Simulate Animal Movement and Mortality Data — simulate_data","text":"Simulate Animal Movement Mortality Data","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/simulate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Animal Movement and Mortality Data — simulate_data","text":"","code":"simulate_data(   n_animals = 200,   n_fixes = 1000,   n_dead = 40,   n_knots = 100,   landscape_size = 1000 )"},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/simulate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Animal Movement and Mortality Data — simulate_data","text":"n_animals Number animals simulate n_fixes Maximum GPS fixes per animal n_dead Number dead animals (must squared number) n_knots Number spatial grid cells landscape_size Size landscape (meters)","code":""},{"path":"http://www.jiangyue-wang.github.io/MortalMove/reference/simulate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Animal Movement and Mortality Data — simulate_data","text":"list containing inputs Stan model","code":""}]
